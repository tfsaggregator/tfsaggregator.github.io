<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Sample polices #  The Unit tests use policy files from UnitTests.Core\ConfigurationsForTests folder, this are the most correct and tested. They do not show how to solve real world
The samples\TFSAggregator2.ServerPlugin.policies should be your starting point. This file contains a no-harm policy: it simply logs an &ldquo;Hello, World&rdquo; message when invoked. The comments remind the syntax.
From time to time, we test the policies contained in the ManualTests folder. They are good to learn but should not be trusted 100%, at least until we are able to setup automated integration testing."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Examples of Policies"><meta property="og:description" content="Aggregator Documentation"><meta property="og:type" content="website"><meta property="og:url" content="https://tfsaggregator.github.io/docs/v2/using/examples/"><title>Examples of Policies | Aggregator</title><link rel=manifest href=https://tfsaggregator.github.io/manifest.json><link rel=icon href=https://tfsaggregator.github.io/favicon.png type=image/x-icon><link rel=stylesheet href=https://tfsaggregator.github.io/book.min.b3215d9d1d18d9051e7fbe8f256ff80e30f41d29073b86348e230d297b771002.css integrity="sha256-syFdnR0Y2QUef76PJW/4DjD0HSkHO4Y0jiMNKXt3EAI="><script defer src=https://tfsaggregator.github.io/en.search.min.94a8808a5458db4a7a736bbfe9ef45f82e38ce011fb3d781778fd81df04e4aa7.js integrity="sha256-lKiAilRY20p6c2u/6e9F+C44zgEfs9eBd4/YHfBOSqc="></script><link rel=alternate type=application/rss+xml href=https://tfsaggregator.github.io/docs/v2/using/examples/index.xml title=Aggregator></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=https://tfsaggregator.github.io/><span>Aggregator</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://tfsaggregator.github.io/docs/v3/>Aggregator 3 (CLI)</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/setup/>Setup</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/setup/azdo-authn/>Azure DevOps Personal Access Token</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/setup/azure/>Azure CLI Setup</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/setup/production/>Azure Production</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/setup/docker/>Docker configuration</a><ul></ul></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/>CLI Commands</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/commands/common-options/>Common options</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/authentication-commands/>Authentication commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/instance-commands/>Instance commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/rule-commands/>Rule commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/map-commands/>Mapping commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/info-commands/>Informational commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/command-examples/>Examples</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/>Rules</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/rules/rule-examples-basic/>Basic examples</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/rule-examples-advanced/>Advanced examples</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/design/>Design</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/design/parallelism/>Parallelism</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/api/>REST API</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/contrib/>Contribute</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/contrib/pipelines/>Pipelines</a></li></ul></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v2/>TFS Aggregator v2</a><ul><li><a href=https://tfsaggregator.github.io/docs/v2/intro/ class=collapsed>Introduction</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/ class=collapsed>Users' Guide</a><ul><li><a href=https://tfsaggregator.github.io/docs/v2/using/writing-rules/writing-rules/>Writing Rules and Policies</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/policy-syntax/>Configuration XML syntax</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/scripting/>Scripting the Rules</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/>Objects Reference</a><ul><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/self-object/>self Object</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/field-object/>Field Object</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/store-object/>store Object</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/logger-object/>logger Object</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/library-objects/>Library Objects</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/ class=active>Examples of Policies</a><ul><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/accumulate-to-grand-parent/>Accumulate to grand-parent example</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/auto-create-children/>Auto-Create Children example</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/auto-open-auto-close/>Auto-Open and Auto-Close example</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/log-time-synch/>Remaining Work and Completed Work synchronization for Task WI</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/rollup/>Rollup examples</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/scripting-tricks-n-tips/scripting-tricks-n-tips/>Tricks & Tips</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/scripting-pitfalls/>Common Pitfalls</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/field-history/>History field</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/upgrade-from-v1/>Upgrading from v1</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v2/admin/ class=collapsed>Administrator Guide</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/contrib/ class=collapsed>Contributing</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/changelog/>Changelog</a></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=https://tfsaggregator.github.io/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Examples of Policies</strong>
<label for=toc-control><img src=https://tfsaggregator.github.io/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#sample-polices>Sample polices</a></li><li><a href=#simple-rules>Simple rules</a><ul><li><a href=#calculated-field>Calculated field</a></li><li><a href=#rollup-field-on-parent>Rollup field on parent</a></li></ul></li><li><a href=#pick-children-satisfying-condition>Pick children satisfying condition</a></li></ul></nav></aside></header><article class=markdown><h2 id=sample-polices>Sample polices
<a class=anchor href=#sample-polices>#</a></h2><p>The Unit tests use policy files from <code>UnitTests.Core\ConfigurationsForTests</code> folder, this are the most correct and tested. They do not show how to solve real world</p><p>The <code>samples\TFSAggregator2.ServerPlugin.policies</code> should be your <strong>starting point</strong>. This file contains a no-harm policy: it simply logs an &ldquo;<em>Hello, World</em>&rdquo; message when invoked. The comments remind the syntax.</p><p>From time to time, we test the policies contained in the <code>ManualTests</code> folder. They are good to learn but should not be trusted 100%, at least until we are able to setup automated integration testing.</p><h2 id=simple-rules>Simple rules
<a class=anchor href=#simple-rules>#</a></h2><h3 id=calculated-field>Calculated field
<a class=anchor href=#calculated-field>#</a></h3><pre><code>&lt;rule name=&quot;Sum&quot; appliesTo=&quot;Task&quot; hasFields=&quot;Title,Description&quot;&gt;&lt;![CDATA[
    self[&quot;Estimated Work&quot;] = (double)self[&quot;Estimated Dev Work&quot;] + (double)self[&quot;Estimated Test Work&quot;];
]]&gt;&lt;/rule&gt;
</code></pre><p>This aggregation will total the values found in the Estimated Dev Work and Estimated Test Work fields for any Task work item.
The total will be placed in the Estimated Work field on the same work item as the source values were found.</p><p><img src=../calculated-field.png alt="Calculated field in form"></p><h3 id=rollup-field-on-parent>Rollup field on parent
<a class=anchor href=#rollup-field-on-parent>#</a></h3><pre><code>&lt;rule name=&quot;Rollup&quot; hasFields=&quot;Estimated Dev Work;Estimated Test Work&quot;&gt;&lt;![CDATA[
  if (self.HasParent()) {
    self.Parent[&quot;Total Estimate&quot;] = (double)self.Parent[&quot;Estimated Dev Work&quot;] + (double)self[&quot;Estimated Test Work&quot;];
  }
]]&gt;&lt;/rule&gt;
</code></pre><p>This aggregation will total the values found in the Estimated Dev Work and Estimated Test Work fields for all Task work items on the parent.
The total will go in the Total Estimate field on the parent one level up from the Task (i.e. the direct parent).
In the Microsoft Visual Studio Scrum template that is always a Bug or Product Backlog Item.</p><blockquote><p><strong>Note on States</strong>: TFS has controls setup on State Transitions.
Most templates do not allow you to go directly from a New state to a Done state.</p></blockquote><h2 id=pick-children-satisfying-condition>Pick children satisfying condition
<a class=anchor href=#pick-children-satisfying-condition>#</a></h2><pre><code>var child in self.Children.Where(
   child =&gt; child.Field.Any(
      field =&gt; field.ReferenceName == &quot;Custom.Product&quot;)
);
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/tfsaggregator/tfsaggregator-docs-hugo/commit/6a7f7214076ec3595b62f5c58a16817466dbf3b3 title="Last modified by Giulio Vian | August 31, 2020" target=_blank rel=noopener><img src=https://tfsaggregator.github.io/svg/calendar.svg class=book-icon alt=Calendar>
<span>August 31, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/tfsaggregator/tfsaggregator-docs-hugo/edit/master/content//docs/v2/using/examples/_index.md target=_blank rel=noopener><img src=https://tfsaggregator.github.io/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#sample-polices>Sample polices</a></li><li><a href=#simple-rules>Simple rules</a><ul><li><a href=#calculated-field>Calculated field</a></li><li><a href=#rollup-field-on-parent>Rollup field on parent</a></li></ul></li><li><a href=#pick-children-satisfying-condition>Pick children satisfying condition</a></li></ul></nav></aside></main></body></html>