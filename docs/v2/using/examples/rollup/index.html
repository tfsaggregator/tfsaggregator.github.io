<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Using Linq to Aggregate #  Applies to Scrum or CMMI Process templates.
<rule name=&#34;RollupTask&#34; appliesTo=&#34;Task&#34;><![CDATA[ if (self.HasParent()) { var parent = self.Parent; parent[&#34;Microsoft.VSTS.Scheduling.CompletedWork&#34;] = parent.Children.Sum(task => task.GetField<double>(&#34;Microsoft.VSTS.Scheduling.CompletedWork&#34;, 0d)); parent[&#34;Microsoft.VSTS.Scheduling.RemainingWork&#34;] = parent.Children.Sum(task => task.GetField<double>(&#34;Microsoft.VSTS.Scheduling.RemainingWork&#34;, 0d)); parent[&#34;Microsoft.VSTS.Scheduling.OriginalEstimate&#34;] = parent.Children.Sum(task => task.GetField<double>(&#34;Microsoft.VSTS.Scheduling.OriginalEstimate&#34;, 0d)); } ]]></rule> This rule updates a Product Backlog Item or Bug whenever any child Task is added or changes. The Completed Work, Remaining Work and Original Estimate on the parent become the sum of the corresponding fields of children Tasks."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Rollup examples"><meta property="og:description" content="Using Linq to Aggregate #  Applies to Scrum or CMMI Process templates.
<rule name=&#34;RollupTask&#34; appliesTo=&#34;Task&#34;><![CDATA[ if (self.HasParent()) { var parent = self.Parent; parent[&#34;Microsoft.VSTS.Scheduling.CompletedWork&#34;] = parent.Children.Sum(task => task.GetField<double>(&#34;Microsoft.VSTS.Scheduling.CompletedWork&#34;, 0d)); parent[&#34;Microsoft.VSTS.Scheduling.RemainingWork&#34;] = parent.Children.Sum(task => task.GetField<double>(&#34;Microsoft.VSTS.Scheduling.RemainingWork&#34;, 0d)); parent[&#34;Microsoft.VSTS.Scheduling.OriginalEstimate&#34;] = parent.Children.Sum(task => task.GetField<double>(&#34;Microsoft.VSTS.Scheduling.OriginalEstimate&#34;, 0d)); } ]]></rule> This rule updates a Product Backlog Item or Bug whenever any child Task is added or changes. The Completed Work, Remaining Work and Original Estimate on the parent become the sum of the corresponding fields of children Tasks."><meta property="og:type" content="article"><meta property="og:url" content="https://tfsaggregator.github.io/docs/v2/using/examples/rollup/"><meta property="article:modified_time" content="2021-06-12T13:16:19+01:00"><title>Rollup examples | Aggregator</title><link rel=manifest href=https://tfsaggregator.github.io/manifest.json><link rel=icon href=https://tfsaggregator.github.io/favicon.png type=image/x-icon><link rel=stylesheet href=https://tfsaggregator.github.io/book.min.b3215d9d1d18d9051e7fbe8f256ff80e30f41d29073b86348e230d297b771002.css integrity="sha256-syFdnR0Y2QUef76PJW/4DjD0HSkHO4Y0jiMNKXt3EAI="><script defer src=https://tfsaggregator.github.io/en.search.min.806e3d96617265ba96a1af820c08377d4d27e6c76a6e546a9be44435f1a18d01.js integrity="sha256-gG49lmFyZbqWoa+CDAg3fU0n5sdqblRqm+RENfGhjQE="></script></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=https://tfsaggregator.github.io/><span>Aggregator</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://tfsaggregator.github.io/docs/v3/>Aggregator 3 (CLI)</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/setup/>Setup</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/setup/azdo-authn/>Azure DevOps Personal Access Token</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/setup/azure/>Azure CLI Setup</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/setup/docker/>Docker configuration</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/setup/production/>Production on Azure</a><ul></ul></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/>CLI Commands</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/commands/common-options/>Common options</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/authentication-commands/>Authentication commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/instance-commands/>Instance commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/rule-commands/>Rule commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/map-commands/>Mapping commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/info-commands/>Informational commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/command-examples/>Examples</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/>Rules</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/rules/directives/>Directives</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/workitem/>WorkItem event objects</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/common-rule-objects/>Common objects</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/rule-examples-basic/>Basic examples</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/rule-examples-advanced/>Advanced examples</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/design/>Design</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/design/caveat/>Caveats</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/design/parallelism/>Parallelism</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/api/>REST API</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/troubleshoot/>Troubleshoot</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/contrib/>Contribute</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/contrib/pipelines/>Pipelines</a></li></ul></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v2/>TFS Aggregator v2</a><ul><li><a href=https://tfsaggregator.github.io/docs/v2/intro/ class=collapsed>Introduction</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/ class=collapsed>Users' Guide</a><ul><li><a href=https://tfsaggregator.github.io/docs/v2/using/writing-rules/writing-rules/>Writing Rules and Policies</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/policy-syntax/>Configuration XML syntax</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/scripting/>Scripting the Rules</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/>Objects Reference</a><ul><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/self-object/>self Object</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/field-object/>Field Object</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/store-object/>store Object</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/logger-object/>logger Object</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/objects-reference/library-objects/>Library Objects</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/>Examples of Policies</a><ul><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/accumulate-to-grand-parent/>Accumulate to grand-parent example</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/auto-create-children/>Auto-Create Children example</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/auto-open-auto-close/>Auto-Open and Auto-Close example</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/log-time-synch/>Remaining Work and Completed Work synchronization for Task WI</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/examples/rollup/ class=active>Rollup examples</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/scripting-tricks-n-tips/scripting-tricks-n-tips/>Tricks & Tips</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/scripting-pitfalls/>Common Pitfalls</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/field-history/>History field</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/upgrade-from-v1/>Upgrading from v1</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v2/admin/ class=collapsed>Administrator Guide</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/contrib/ class=collapsed>Contributing</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/changelog/>Changelog</a></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=https://tfsaggregator.github.io/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Rollup examples</strong>
<label for=toc-control><img src=https://tfsaggregator.github.io/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#using-linq-to-aggregate>Using Linq to Aggregate</a></li><li><a href=#aggregating-wits-hierarhy-from-task-to-epic-level>Aggregating WIT&rsquo;s hierarhy from Task to Epic level</a></li></ul></nav></aside></header><article class=markdown><h2 id=using-linq-to-aggregate>Using Linq to Aggregate
<a class=anchor href=#using-linq-to-aggregate>#</a></h2><p>Applies to <em>Scrum</em> or <em>CMMI</em> Process templates.</p><pre><code>&lt;rule name=&quot;RollupTask&quot; appliesTo=&quot;Task&quot;&gt;&lt;![CDATA[
if (self.HasParent())
{
    var parent = self.Parent;
    parent[&quot;Microsoft.VSTS.Scheduling.CompletedWork&quot;] = parent.Children.Sum(task =&gt; task.GetField&lt;double&gt;(&quot;Microsoft.VSTS.Scheduling.CompletedWork&quot;, 0d));
    parent[&quot;Microsoft.VSTS.Scheduling.RemainingWork&quot;] = parent.Children.Sum(task =&gt; task.GetField&lt;double&gt;(&quot;Microsoft.VSTS.Scheduling.RemainingWork&quot;, 0d));
    parent[&quot;Microsoft.VSTS.Scheduling.OriginalEstimate&quot;] = parent.Children.Sum(task =&gt; task.GetField&lt;double&gt;(&quot;Microsoft.VSTS.Scheduling.OriginalEstimate&quot;, 0d));
}
]]&gt;&lt;/rule&gt;
</code></pre><p>This rule updates a Product Backlog Item or Bug whenever any child Task is added or changes. The <em>Completed Work</em>, <em>Remaining Work</em> and <em>Original Estimate</em> on the parent become the sum of the corresponding fields of children Tasks.
Note that children Bug or Test Case do not update the parent for the <code>appliesTo</code> clause.</p><h2 id=aggregating-wits-hierarhy-from-task-to-epic-level>Aggregating WIT&rsquo;s hierarhy from Task to Epic level
<a class=anchor href=#aggregating-wits-hierarhy-from-task-to-epic-level>#</a></h2><p>You need to ensure that you have Microsoft.VSTS.Scheduling.RemainingWork on all WIT&rsquo;s involved</p><pre><code>&lt;rule name=&quot;RollupTask&quot; appliesTo=&quot;Task&quot;&gt;&lt;![CDATA[
if (self.HasParent())
{
    var parent = self.Parent;
     parent[&quot;Microsoft.VSTS.Scheduling.RemainingWork&quot;] = parent.Children.Sum(task =&gt; task.GetField&lt;double&gt;(&quot;Microsoft.VSTS.Scheduling.RemainingWork&quot;, 0d));
}
]]&gt;&lt;/rule&gt;

&lt;rule name=&quot;RollupPBI&quot; appliesTo=&quot;Product Backlog Item&quot;&gt;&lt;![CDATA[
if (self.HasParent())
{
    var parent = self.Parent;
     parent[&quot;Microsoft.VSTS.Scheduling.RemainingWork&quot;] = parent.Children.Sum(pbi =&gt; pbi.GetField&lt;double&gt;(&quot;Microsoft.VSTS.Scheduling.RemainingWork&quot;, 0d));
}
]]&gt;&lt;/rule&gt;

&lt;rule name=&quot;RollupEpic&quot; appliesTo=&quot;Feature&quot;&gt;&lt;![CDATA[
if (self.HasParent())
{
    var parent = self.Parent;
     parent[&quot;Microsoft.VSTS.Scheduling.RemainingWork&quot;] = parent.Children.Sum(feature =&gt; feature.GetField&lt;double&gt;(&quot;Microsoft.VSTS.Scheduling.RemainingWork&quot;, 0d));
}
]]&gt;&lt;/rule&gt;
</code></pre><p>This rule updates all WIT&rsquo;s (up to Epic level) whenever any child WIT is added or changes. The <em>Remaining Work</em> on the parents become the sum of the <em>Remaining Work</em> of children&rsquo;s WIT&rsquo;s.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/tfsaggregator/tfsaggregator-docs-hugo/commit/98ff02656ce807065814dc5a01315f4e37f024f3 title="Last modified by Giulio Vian | June 12, 2021" target=_blank rel=noopener><img src=https://tfsaggregator.github.io/svg/calendar.svg class=book-icon alt=Calendar>
<span>June 12, 2021</span></a></div><div><a class="flex align-center" href=https://github.com/tfsaggregator/tfsaggregator-docs-hugo/edit/master/content//docs/v2/using/examples/rollup.md target=_blank rel=noopener><img src=https://tfsaggregator.github.io/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#using-linq-to-aggregate>Using Linq to Aggregate</a></li><li><a href=#aggregating-wits-hierarhy-from-task-to-epic-level>Aggregating WIT&rsquo;s hierarhy from Task to Epic level</a></li></ul></nav></aside></main></body></html>