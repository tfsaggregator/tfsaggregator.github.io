<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="TFS Aggregator logging is quite rich but the exact configuration depends on your environment.
Logging levels #  The possible Logging levels are: Critical, Error, Warning, Information or Normal, Verbose, and Diagnostic.
Enable Debug Logging #  To control the verbosity in TFS Aggregator, you have to set a level attribute to the logging element in your TFSAggregator2.ServerPlugin.policies file. Use a value like Verbose or Diagnostic.
<?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?> <AggregatorConfiguration> <runtime> <logging level=&#34;Diagnostic&#34;/> </runtime> Note that you can use the logger object in your rules to trace execution and values."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Logging"><meta property="og:description" content="TFS Aggregator logging is quite rich but the exact configuration depends on your environment.
Logging levels #  The possible Logging levels are: Critical, Error, Warning, Information or Normal, Verbose, and Diagnostic.
Enable Debug Logging #  To control the verbosity in TFS Aggregator, you have to set a level attribute to the logging element in your TFSAggregator2.ServerPlugin.policies file. Use a value like Verbose or Diagnostic.
<?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?> <AggregatorConfiguration> <runtime> <logging level=&#34;Diagnostic&#34;/> </runtime> Note that you can use the logger object in your rules to trace execution and values."><meta property="og:type" content="article"><meta property="og:url" content="https://tfsaggregator.github.io/docs/v2/admin/logging/"><meta property="article:modified_time" content="2022-08-10T20:02:52+02:00"><title>Logging | Aggregator</title><link rel=manifest href=https://tfsaggregator.github.io/manifest.json><link rel=icon href=https://tfsaggregator.github.io/favicon.png type=image/x-icon><link rel=stylesheet href=https://tfsaggregator.github.io/book.min.b3215d9d1d18d9051e7fbe8f256ff80e30f41d29073b86348e230d297b771002.css integrity="sha256-syFdnR0Y2QUef76PJW/4DjD0HSkHO4Y0jiMNKXt3EAI="><script defer src=https://tfsaggregator.github.io/en.search.min.6b0c0810f944b5aabd6ed910dbc5fc8b635bcd388c47fb0efd899da47c849819.js integrity="sha256-awwIEPlEtaq9btkQ28X8i2NbzTiMR/sO/YmdpHyEmBk="></script></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=https://tfsaggregator.github.io/><span>Aggregator</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://tfsaggregator.github.io/docs/v3/>Aggregator 3 (CLI)</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/setup/>Setup</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/setup/azdo-authn/>Azure DevOps Personal Access Token</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/setup/azure/>Azure CLI Setup</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/setup/docker/>Docker configuration</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/setup/production/>Production on Azure</a><ul></ul></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/>CLI Commands</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/commands/common-options/>Common options</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/authentication-commands/>Authentication commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/instance-commands/>Instance commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/rule-commands/>Rule commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/map-commands/>Mapping commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/info-commands/>Informational commands</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/commands/command-examples/>Examples</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/>Rules</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/rules/directives/>Directives</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/workitem/>WorkItem event objects</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/common-rule-objects/>Common objects</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/rule-examples-basic/>Basic examples</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/rules/rule-examples-advanced/>Advanced examples</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/design/>Design</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/design/caveat/>Caveats</a></li><li><a href=https://tfsaggregator.github.io/docs/v3/design/parallelism/>Parallelism</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/api/>REST API</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/troubleshoot/>Troubleshoot</a><ul></ul></li><li><a href=https://tfsaggregator.github.io/docs/v3/contrib/>Contribute</a><ul><li><a href=https://tfsaggregator.github.io/docs/v3/contrib/pipelines/>Pipelines</a></li></ul></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v2/>TFS Aggregator v2</a><ul><li><a href=https://tfsaggregator.github.io/docs/v2/intro/ class=collapsed>Introduction</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/using/ class=collapsed>Users' Guide</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/admin/ class=collapsed>Administrator Guide</a><ul><li><a href=https://tfsaggregator.github.io/docs/v2/admin/install/>Installing the Server Plugin</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/admin/install-webhooks/>Installing the Web Service</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/admin/console-app/>Using the console to test Policies</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/admin/logging/ class=active>Logging</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/admin/troubleshooting/>Troubleshooting</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/admin/support/>Support</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/admin/security/>Security</a></li></ul></li><li><a href=https://tfsaggregator.github.io/docs/v2/contrib/ class=collapsed>Contributing</a></li><li><a href=https://tfsaggregator.github.io/docs/v2/changelog/>Changelog</a></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=https://tfsaggregator.github.io/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Logging</strong>
<label for=toc-control><img src=https://tfsaggregator.github.io/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#logging-levels>Logging levels</a></li><li><a href=#enable-debug-logging>Enable Debug Logging</a></li><li><a href=#startup-logging-23>Startup logging (2.3)</a></li><li><a href=#capturing-log-on-tfs>Capturing log on TFS</a></li><li><a href=#capturing-log-on-azure>Capturing log on Azure</a></li><li><a href=#tfs-production-logging-21>TFS Production Logging (2.1)</a></li></ul></nav></aside></header><article class=markdown><p>TFS Aggregator logging is quite rich but the exact configuration depends on your environment.</p><h2 id=logging-levels>Logging levels
<a class=anchor href=#logging-levels>#</a></h2><p>The possible Logging levels are: <code>Critical</code>, <code>Error</code>, <code>Warning</code>, <code>Information</code> or <code>Normal</code>, <code>Verbose</code>, and <code>Diagnostic</code>.</p><h2 id=enable-debug-logging>Enable Debug Logging
<a class=anchor href=#enable-debug-logging>#</a></h2><p>To control the verbosity in TFS Aggregator, you have to set a <code>level</code> attribute to the <code>logging</code> element in your <code>TFSAggregator2.ServerPlugin.policies</code> file.
Use a value like <code>Verbose</code> or <code>Diagnostic</code>.</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;AggregatorConfiguration&gt;
    &lt;runtime&gt;
        &lt;logging level=&quot;Diagnostic&quot;/&gt;
    &lt;/runtime&gt;
</code></pre><p>Note that you can use the <a href=https://tfsaggregator.github.io/using/objects-reference/logger-object/><code>logger</code> object</a> in your rules to trace execution and values.</p><h2 id=startup-logging-23>Startup logging (2.3)
<a class=anchor href=#startup-logging-23>#</a></h2><p>During TFS Aggregator start, before the Policies file is read, the logging level is controlled by <code>TFSAggregator2.ServerPlugin.dll.config</code>, for the Server Plugin, and by <code>Web.config</code>, for the Web Service, through the <code>DefaultLoggingLevel</code> key in the <code>appSettings</code> section, as in this example.</p><pre><code>&lt;configuration&gt;
  &lt;appSettings&gt;
    &lt;add key=&quot;DefaultLoggingLevel&quot; value=&quot;Verbose&quot;/&gt;
  &lt;/appSettings&gt;
&lt;/configuration&gt;
</code></pre><p>If the file or section is absent, the default value is <code>Normal</code>.</p><h2 id=capturing-log-on-tfs>Capturing log on TFS
<a class=anchor href=#capturing-log-on-tfs>#</a></h2><p>For TFS on premises or hosted, you can download <a href=https://technet.microsoft.com/en-us/sysinternals/debugview.aspx><strong>DebugView</strong></a> from Microsoft&rsquo;s SysInternals site.</p><p>DebugView is a Trace Listener and will capture the trace messages from TFS Aggregator.
<img src=./messages-in-dbgview.png alt="TFSAggregator messages in DebugView"></p><blockquote><p><strong>You have to run DebugView on <em>all</em> TFS Application Tier machines</strong>.</p></blockquote><p>We would recommend adding the <code>*TFSAggregator*</code> filter to DebugView so that you only see the TFS Aggregator traces.</p><p><img src=./dbg-view-filter.png alt></p><p>Make sure to enable the <strong>Capture Global Win32</strong> option.
<img src=./dbg-view-capture.png alt></p><p>Download DebugView at <a href=http://technet.microsoft.com/en-us/sysinternals/bb896647>http://technet.microsoft.com/en-us/sysinternals/bb896647</a>.</p><h2 id=capturing-log-on-azure>Capturing log on Azure
<a class=anchor href=#capturing-log-on-azure>#</a></h2><p>In this scenario you deployed the TFS Aggregator Web Service using the <em>Deploy to Azure</em> button.</p><p>In the <a href=https://portal.azure.com/>Azure Portal</a> navigate to <strong>App Services</strong> and select the App Service hosting TFS Aggregator. Scroll down to <strong>Diagnostic logs</strong> and turn on <strong>Application Logging</strong>.</p><p><img src=./3-log1.png alt></p><p>Select the Verbosity level and save.</p><blockquote><p>You can store the logs in Azure storage for auditing.</p></blockquote><p>In the Kudu console navigate to the <code>LogFiles\Application</code> folder to find the log files produced by TFS Aggregator.</p><p><img src=./3-log2.png alt></p><p>By opening the file you see a snapshot of log file&rsquo;s content.</p><p><img src=./3-log3.png alt="Content of a log file"></p><h2 id=tfs-production-logging-21>TFS Production Logging (2.1)
<a class=anchor href=#tfs-production-logging-21>#</a></h2><p>TFS Aggregator log messages go to:</p><ul><li>Debug output (appers in the Output window of a debugger)</li><li>Application EventLog (<em>TFS Aggregator</em> source) when message level is <code>Warning</code> or <code>Critical</code></li><li>Trace listeners</li></ul><p>User messages &ndash; i.e. <code>logger.Log</code> calls in Rules &ndash; use a specific Trace source: <code>TfsAggregator.User</code>.</p><p>Now, you can send traces to a file by adding to TFS <code>web.config</code> a <code>system.diagnostics</code> section similar to the this:</p><pre><code>&lt;system.diagnostics&gt;
  &lt;sources&gt;
    &lt;source name=&quot;TfsAggregator.ServerPlugin&quot; switchValue=&quot;All&quot;&gt;
      &lt;listeners&gt;
        &lt;remove name=&quot;Default&quot; /&gt;
        &lt;add name=&quot;filelog&quot; /&gt;
      &lt;/listeners&gt;
    &lt;/source&gt;
    &lt;source name=&quot;TfsAggregator.User&quot; switchValue=&quot;All&quot;&gt;
      &lt;listeners&gt;
        &lt;remove name=&quot;Default&quot; /&gt;
        &lt;add name=&quot;filelog&quot; /&gt;
      &lt;/listeners&gt;
    &lt;/source&gt;
  &lt;/sources&gt;
  &lt;sharedListeners&gt;
    &lt;add name=&quot;filelog&quot;
         type=&quot;Microsoft.VisualBasic.Logging.FileLogTraceListener, 
                   Microsoft.VisualBasic, Version=10.0.0.0, 
                   Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;
         BaseFileName=&quot;TfsAggregator.log&quot;
         DiskSpaceExhaustedBehavior=&quot;ThrowException&quot;
         Location=&quot;Custom&quot;
         CustomLocation = &quot;C:\Temp&quot;
         MaxFileSize=&quot;81920000&quot;
         LogFileCreationSchedule=&quot;Daily&quot;/&gt;
  &lt;/sharedListeners&gt;
  &lt;trace autoflush=&quot;true&quot;/&gt;
&lt;/system.diagnostics&gt;
</code></pre><p>TFS web.config is usually located in <code>C:\Program Files\Microsoft Team Foundation Server 15.0\Application Tier\Web Services\web.config</code> or similar.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/tfsaggregator/tfsaggregator-docs-hugo/commit/6909cc5d84c15ed40e7fddb3407597a1822c2b13 title="Last modified by Jesse Houwing | August 10, 2022" target=_blank rel=noopener><img src=https://tfsaggregator.github.io/svg/calendar.svg class=book-icon alt=Calendar>
<span>August 10, 2022</span></a></div><div><a class="flex align-center" href=https://github.com/tfsaggregator/tfsaggregator-docs-hugo/edit/master/content//docs/v2/admin/logging/index.md target=_blank rel=noopener><img src=https://tfsaggregator.github.io/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#logging-levels>Logging levels</a></li><li><a href=#enable-debug-logging>Enable Debug Logging</a></li><li><a href=#startup-logging-23>Startup logging (2.3)</a></li><li><a href=#capturing-log-on-tfs>Capturing log on TFS</a></li><li><a href=#capturing-log-on-azure>Capturing log on Azure</a></li><li><a href=#tfs-production-logging-21>TFS Production Logging (2.1)</a></li></ul></nav></aside></main></body></html>